{"version":3,"sources":["workers/syncWorker.js"],"names":["self","importScripts","info","cursKey","category","postSyncAction","POST_ACTION_RECACHING_RESTAURANT_REVIEWS","onmessage","message","data","syncReview","syncFavoritify","syncUpdateReviewAction","syncDeletedReview","replyToWorker","serverResponse","key","responseMessage","postMessage","createNewRestaurantReview","undefined","reviewID","jsonInfo","JSON","parse","deleteReview","id","updateRestaurantReview","restaurantID","is_fav","favoriteRestaurant"],"mappings":";;AACAA,KAAKC,aAAL,CAAmB,8BAAnB;;AAEA,IAAIC,IAAJ,EAAUC,OAAV,EAAmBC,QAAnB,EAA6BC,cAA7B;;AAEA,IAAMC,2CAA2C,4BAAjD;;AAEAN,KAAKO,SAAL,GAAiB,UAACC,OAAD,EAAW;AAC3BR,MAAKE,IAAL,GAAYM,QAAQC,IAAR,CAAaP,IAAzB;AACAF,MAAKG,OAAL,GAAcK,QAAQC,IAAR,CAAaN,OAA3B;AACAH,MAAKI,QAAL,GAAgBI,QAAQC,IAAR,CAAaL,QAA7B;;AAEA,KAAGA,WAAW,KAAd,EAAoB;AACnBM,aAAWR,IAAX,EAAiBC,OAAjB;AACAH,OAAKK,cAAL,GAAsBC,wCAAtB;AACA,EAHD,MAGM,IAAGF,WAAW,KAAd,EAAoB;AACzB;AACA;AACAO,iBAAeT,IAAf,EAAqB,IAArB;AACA,EAJK,MAIA,IAAGE,WAAW,KAAd,EAAoB;AACzB;AACA;AACAO,iBAAeT,IAAf,EAAqB,KAArB;AACA,EAJK,MAIA,IAAGE,WAAU,KAAb,EAAmB;AACxB;AACA;AACAQ,yBAAuBV,IAAvB,EAA6BC,OAA7B;AACA,EAJK,MAIA,IAAGC,WAAW,KAAd,EAAoB;AACzB;AACA;AACAS,oBAAkBX,IAAlB,EAAwBC,OAAxB;AACAH,OAAKK,cAAL,GAAsBC,wCAAtB;AACA;AACD,CA1BD;;AA4BA,IAAIQ,gBAAe,SAAfA,aAAe,CAACC,cAAD,EAAsC;AAAA,KAArBC,GAAqB,uEAAfhB,KAAKG,OAAU;;AACxD,KAAGY,cAAH,EAAkB;AACjB,MAAIE,kBAAkB,EAAC,eAAe,IAAhB,EAAsB,WAAWD,GAAjC,EAAsC,kBAAkBX,cAAxD,EAAtB;;AAEAa,cAAYD,eAAZ;AACA;AACD,CAND;;AAQA,IAAIP,aAAY,SAAZA,UAAY,CAACR,IAAD,EAAOC,OAAP,EAAiB;AAChCgB,2BAA0BjB,IAA1B,EAAgCY,aAAhC,EAA+CM,SAA/C;AACA,CAFD;;AAIA,IAAIP,oBAAmB,SAAnBA,iBAAmB,CAACQ,QAAD,EAAWlB,OAAX,EAAqB;AAC3C,KAAImB,WAAWC,KAAKC,KAAL,CAAWH,QAAX,CAAf;AACAI,cAAaH,SAASI,EAAtB,EAA0BZ,aAA1B,EAAyCM,SAAzC;AACA,CAHD;;AAKA,IAAIR,yBAAuB,SAAvBA,sBAAuB,CAACV,IAAD,EAAOC,OAAP,EAAiB;AAC3CwB,wBAAuBzB,IAAvB,EAA6BY,aAA7B,EAA4CM,SAA5C;AACA,CAFD;;AAIA,IAAIT,iBAAgB,SAAhBA,cAAgB,CAACiB,YAAD,EAAeC,MAAf,EAAwB;AAC3CC,oBAAmBF,YAAnB,EAAiCC,MAAjC,EAAyCf,aAAzC,EAAwDM,SAAxD;AACA,CAFD","file":"syncWorker.js","sourcesContent":["\r\nself.importScripts('../modificationOperations.js');\r\n\r\nvar info, cursKey, category, postSyncAction;\r\n\r\nconst POST_ACTION_RECACHING_RESTAURANT_REVIEWS = 'recachingRestaurantReviews';\r\n\r\nself.onmessage = (message)=>{\r\n\tself.info = message.data.info;\r\n\tself.cursKey= message.data.cursKey;\r\n\tself.category = message.data.category;\r\n\t\r\n\tif(category < 10000){\r\n\t\tsyncReview(info, cursKey);\r\n\t\tself.postSyncAction = POST_ACTION_RECACHING_RESTAURANT_REVIEWS;\r\n\t}else if(category < 20000){\r\n\t\t// TODO\r\n\t\t// Favorite a restaurant\r\n\t\tsyncFavoritify(info, true);\r\n\t}else if(category < 30000){\r\n\t\t// TODO\r\n\t\t// Unfavorite a restaurant \r\n\t\tsyncFavoritify(info, false);\r\n\t}else if(category< 40000){\r\n\t\t// TODO\r\n\t\t// Update a restaurant review\r\n\t\tsyncUpdateReviewAction(info, cursKey);\r\n\t}else if(category < 50000){\r\n\t\t// TODO\r\n\t\t// Delete a restaurant review\r\n\t\tsyncDeletedReview(info, cursKey);\r\n\t\tself.postSyncAction = POST_ACTION_RECACHING_RESTAURANT_REVIEWS;\r\n\t}\r\n}\r\n\r\nvar replyToWorker= (serverResponse, key = self.cursKey)=>{\r\n\tif(serverResponse){\r\n\t\tlet responseMessage = {'isCompleted': true, 'cursKey': key, 'postSyncAction': postSyncAction};\r\n\r\n\t\tpostMessage(responseMessage);\r\n\t}\r\n}\r\n\r\nvar syncReview =(info, cursKey)=>{\r\n\tcreateNewRestaurantReview(info, replyToWorker, undefined);\r\n}\r\n\r\nvar syncDeletedReview= (reviewID, cursKey)=>{\r\n\tlet jsonInfo = JSON.parse(reviewID);\r\n\tdeleteReview(jsonInfo.id, replyToWorker, undefined);\r\n}\r\n\r\nvar syncUpdateReviewAction=(info, cursKey)=>{\r\n\tupdateRestaurantReview(info, replyToWorker, undefined);\r\n}\r\n\r\nvar syncFavoritify =(restaurantID, is_fav)=>{\r\n\tfavoriteRestaurant(restaurantID, is_fav, replyToWorker, undefined);\r\n}"]}