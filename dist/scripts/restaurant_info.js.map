{"version":3,"sources":["restaurant_info.js"],"names":["restaurant","map","resturantID","restaurantReviewsList","CATEGORY_NEW_REVIEW","CATEGORY_DELETE_REVIEW","CATEGORY_UPDATE_REVIEW","originalModifiedReviewsInnerHTML","Map","EDIT_REVIEW_NAME_ID_PREFIX","EDIT_REVIEW_RATING_ID_PREFIX","EDIT_REVIEW_COMM_ID_PREFIX","EDIT_REVIEW_RADIO_NAME_PREF","SINGLE_REVIEW_DIV_PREFIX","window","initMap","fetchRestaurantFromURL","error","console","self","google","maps","document","getElementById","zoom","center","latlng","scrollwheel","fillBreadcrumb","DBHelper","mapMarkerForRestaurant","callback","id","getParameterByName","fetchRestaurantById","fillRestaurantHTML","fetchRestaurantReviews","fillReviewsHTML","afterSubmittingReviewFail","name","innerHTML","heartClass","is_favorite","favSpan","createElement","CONST_FAVORITIFY_ACTION_SPAN_ID_PREFIX","className","setAttribute","appendChild","address","picture","imgsList","imagesUrlForRestaurant","img1","media","srcset","img2","img","alt","cuisine_type","src","cuisine","operating_hours","fillRestaurantHoursHTML","operatingHours","hours","key","row","day","time","reviews","container","noReviews","ul","Worker","revWorker","postMessage","onmessage","message","content","data","forEach","createReviewHTML","review","li","date","createDate","Date","createdAt","toDateString","head","rating","getRatingClassName","createEditAndDeleteButtons","comments","div","bt1","spn1","btn2","spn2","rate","rateName","breadcrumb","a","href","url","location","replace","regex","RegExp","results","exec","decodeURIComponent","getSubmittedReviewInfoAndValidation","nameID","rateID","commID","value","comm","rateList","getElementsByName","i","length","checked","undefined","alert","reviewInfo","now","submitUserReviewForm","log","jsonData","JSON","stringify","fetch","method","body","headers","then","response","json","catch","e","jsonObj","afterSubmittingReviewSuccess","addToSyncListReviews","clearSubmittedReview","reviewerName","reviewerComment","deleteReviewAction","reviewID","result","confirm","successCallback","customNotification","failCallback","revid","obj","storedObject","afterDeletingReviewFailure","deleteReview","revDiv","getReviewByID","index","createEditReviewSection","revDev","set","hd","p1","type","nmLbl","rateDiv1","generateRatingStars","commLbl","createEdititedReviewActionsButtons","save","sp1","cancel","sp2","rateDiv","revID","generateStar","val","txt","s1","l1","title","Number","parseInt","editExistingReview","cancelEditingReview","info","get","delete","saveUpdatedReview","review_id","myRev","mydiv","updateRestaurantReview"],"mappings":"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","file":"restaurant_info.js","sourcesContent":["let restaurant;\r\nvar map;\r\nlet resturantID;\r\nlet restaurantReviewsList;\r\n\r\nconst CATEGORY_NEW_REVIEW = 'NewReview';\r\nconst CATEGORY_DELETE_REVIEW = 'DeleteReview';\r\nconst CATEGORY_UPDATE_REVIEW = 'UpdateReview';\r\n\r\nvar originalModifiedReviewsInnerHTML = new Map();\r\nconst EDIT_REVIEW_NAME_ID_PREFIX = 'edit_review_name_';\r\nconst EDIT_REVIEW_RATING_ID_PREFIX = 'edit_review_rating_';\r\nconst EDIT_REVIEW_COMM_ID_PREFIX = 'edit_review_comm_';\r\nconst EDIT_REVIEW_RADIO_NAME_PREF = '_rating_';\r\nconst SINGLE_REVIEW_DIV_PREFIX = 'review_';\r\n/**\r\n * Initialize Google map, called from HTML.\r\n */\r\n\r\nwindow.initMap = () => {\r\n  fetchRestaurantFromURL((error, restaurant) => {\r\n    if (error) { // Got an error!\r\n      console.error(error);\r\n    } else {\r\n      self.map = new google.maps.Map(document.getElementById('map'), {\r\n        zoom: 16,\r\n        center: restaurant.latlng,\r\n        scrollwheel: false\r\n      });\r\n      fillBreadcrumb();\r\n      DBHelper.mapMarkerForRestaurant(self.restaurant, self.map);\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Get current restaurant from page URL.\r\n */\r\nvar fetchRestaurantFromURL = (callback) => {\r\n  if (self.restaurant) { // restaurant already fetched!\r\n    callback(null, self.restaurant)\r\n    return;\r\n  }\r\n  const id = getParameterByName('id');\r\n  self.resturantID = id;\r\n  if (!id) { // no id found in URL\r\n    error = 'No restaurant id in URL'\r\n    callback(error, null);\r\n  } else {\r\n    DBHelper.fetchRestaurantById(id, (error, restaurant) => {\r\n      self.restaurant = restaurant;\r\n      if (!restaurant) {\r\n        console.error(error);\r\n        return;\r\n      }\r\n      fillRestaurantHTML();\r\n      callback(null, restaurant)\r\n    });\r\n\r\n    DBHelper.fetchRestaurantReviews(id, \r\n    //   (error, reviews) => {\r\n    //   if (!reviews) {\r\n    //     console.error(error);\r\n    //     return;\r\n    //   }\r\n    //   fillReviewsHTML(reviews);\r\n    // }\r\n    fillReviewsHTML, afterSubmittingReviewFail);\r\n  }\r\n}\r\n\r\n/**\r\n * Create restaurant HTML and add it to the webpage\r\n */\r\nvar fillRestaurantHTML = (restaurant = self.restaurant) => {\r\n  const name = document.getElementById('restaurant-name');\r\n  name.innerHTML = restaurant.name;\r\n\r\n  let heartClass = 'fontawesome-heart-empty';\r\n  if(restaurant.is_favorite === true || restaurant.is_favorite === 'true'){\r\n    heartClass = 'fontawesome-heart';\r\n  }\r\n  let favSpan = document.createElement('button');\r\n  favSpan.id = `${CONST_FAVORITIFY_ACTION_SPAN_ID_PREFIX}${restaurant.id}`;\r\n  favSpan.className = heartClass;\r\n  favSpan.setAttribute('onclick',`markRestaurantAsFavorit(${restaurant.id}, ${restaurant.is_favorite}, -1)`);\r\n  favSpan.setAttribute('role', 'presentation');\r\n  favSpan.setAttribute('aria-label', 'Add to Favorite');\r\n  name.appendChild(favSpan);\r\n\r\n  const address = document.getElementById('restaurant-address');\r\n  address.innerHTML = restaurant.address;\r\n\r\n  // TODO picture from HTML and change the requirement from here.\r\n  const picture = document.getElementById('restaurant-img');\r\n  picture.className = 'restaurant-img';\r\n//  image.src = DBHelper.imageUrlForRestaurant(restaurant);\r\n  \r\n  \r\n\tlet imgsList = DBHelper.imagesUrlForRestaurant(restaurant);\r\n\tconst img1 = document.createElement('source');\r\n\timg1.media = '(min-width: 1500px)';\r\n\timg1.srcset = imgsList[0];\r\n\timg1.className = 'restaurant-img';\r\n\tpicture.appendChild(img1);\r\n\tconst img2 = document.createElement('source');\r\n\timg2.media = '(min-width: 800px)';\r\n\timg2.srcset = imgsList[1];\r\n\timg2.className = 'restaurant-img';\r\n\tpicture.appendChild(img2);\r\n\tconst img = document.createElement('img');\r\n\timg.alt = restaurant.name + ' restaurant , provide ' + restaurant.cuisine_type + ', Located in ' + restaurant.address;\r\n\timg.src = imgsList[2];\r\n\timg.className = 'restaurant-img';\r\n\tpicture.appendChild(img);\r\n  \r\n  \r\n  const cuisine = document.getElementById('restaurant-cuisine');\r\n  cuisine.innerHTML = restaurant.cuisine_type;\r\n\r\n  // fill operating hours\r\n  if (restaurant.operating_hours) {\r\n    fillRestaurantHoursHTML();\r\n  }\r\n  // // fill reviews\r\n  // fillReviewsHTML();\r\n}\r\n\r\n/**\r\n * Create restaurant operating hours HTML table and add it to the webpage.\r\n */\r\nvar fillRestaurantHoursHTML = (operatingHours = self.restaurant.operating_hours) => {\r\n  const hours = document.getElementById('restaurant-hours');\r\n  for (let key in operatingHours) {\r\n    const row = document.createElement('tr');\r\n\r\n    const day = document.createElement('td');\r\n    day.innerHTML = key;\r\n    row.appendChild(day);\r\n\r\n    const time = document.createElement('td');\r\n    time.innerHTML = operatingHours[key];\r\n    row.appendChild(time);\r\n\r\n    hours.appendChild(row);\r\n  }\r\n}\r\n\r\n/**\r\n * Create all reviews HTML and add them to the webpage.\r\n */\r\nvar fillReviewsHTML = (error ,reviews = self.restaurant.reviews) => {\r\n  const container = document.getElementById('reviews-container');\r\n  // const title = document.createElement('h3');\r\n  // title.innerHTML = 'Reviews';\r\n  // container.appendChild(title);\r\n\r\n  if (error || !reviews) {\r\n    const noReviews = document.createElement('p');\r\n    noReviews.innerHTML = 'No reviews yet!';\r\n    container.appendChild(noReviews);\r\n    return;\r\n  }else{\r\n    self.restaurantReviewsList = reviews;\r\n    const ul = document.getElementById('reviews-list');\r\n     ul.innerHTML = '';\r\n    if(window.Worker){\r\n      let revWorker = new Worker('scripts/workers/restaurantReviewsPreparation.js');\r\n      revWorker.postMessage({'reviews': reviews});\r\n      revWorker.onmessage = (message)=>{\r\n        let content = message.data.ul;\r\n        ul.innerHTML = ul.innerHTML + content;\r\n      }\r\n    }else{\r\n\r\n      reviews.forEach(review => {\r\n        ul.appendChild(createReviewHTML(review));\r\n      });\r\n      container.appendChild(ul);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Create review HTML and add it to the webpage.\r\n */\r\nvar createReviewHTML = (review, li = document.createElement('div')) => {\r\n  // const li = document.createElement('div');\r\n  \r\n  const name = document.createElement('p1');\r\n  name.innerHTML = review.name;\r\n//  li.appendChild(name);\r\n\r\n  const date = document.createElement('p2');\r\n  // date.innerHTML = review.date;\r\n//  li.appendChild(date);\r\n  let createDate = new Date(review.createdAt);\r\n  date.innerHTML = createDate.toDateString();\r\n\r\n  const head = document.createElement('h4');\r\n  head.appendChild(name);\r\n  head.appendChild(date);\r\n  head.className = 'reviewHead';\r\n  li.appendChild(head);\r\n  \r\n  const rating = document.createElement('p3');\r\n  rating.innerHTML = `Rating: ${review.rating}`; \r\n\trating.className = 'reviewRate ' + getRatingClassName(review.rating);\r\n  li.appendChild(rating);\r\n\r\n  createEditAndDeleteButtons(li, review);\r\n\r\n  const comments = document.createElement('p');\r\n  comments.innerHTML = review.comments;\r\n  li.appendChild(comments);\r\n\r\n  return li;\r\n}\r\n\r\n\r\nvar createEditAndDeleteButtons=(div, review)=>{\r\n  let bt1 = document.createElement('button');\r\n  bt1.setAttribute('onclick', `editExistingReview(${review.id})`);\r\n  let spn1 = document.createElement('span');\r\n  spn1.className = 'fontawesome-edit';\r\n  spn1.innerHTML = 'Edit';\r\n  bt1.className = 'reviewActionButton';\r\n  bt1.setAttribute('role', 'presentation');\r\n  bt1.setAttribute('aria-label', 'Edit Review');\r\n  bt1.appendChild(spn1);\r\n\r\n  let btn2 = document.createElement('button');\r\n  btn2.setAttribute('onclick',`deleteReviewAction(${review.id})`);\r\n  let spn2 = document.createElement('span');\r\n  spn2.className = 'fontawesome-cut';\r\n  spn2.innerHTML = 'Delete';\r\n  btn2.className = 'reviewActionButton';\r\n  btn2.setAttribute('role', 'presentation');\r\n  btn2.setAttribute('aria-label', 'Delete Review');\r\n  btn2.appendChild(spn2);\r\n\r\n  div.appendChild(btn2);\r\n  div.appendChild(bt1);\r\n}\r\n\r\nvar getRatingClassName = (rate) =>{\r\n\tlet rateName = 'unknownRate';\r\n\tif(rate == 0){\r\n\t\trateName = 'rate0';\r\n\t}else if(rate == 1){\r\n\t\trateName = 'rate1';\r\n\t}else if(rate == 2){\r\n\t\trateName = 'rate2';\r\n\t}else if(rate == 3){\r\n\t\trateName = 'rate3';\r\n\t}else if(rate == 4){\r\n\t\trateName = 'rate4';\r\n\t}else if(rate == 5){\r\n\t\trateName = 'rate5';\r\n\t}\r\n\treturn rateName;\r\n}\r\n\r\n/**\r\n * Add restaurant name to the breadcrumb navigation menu\r\n */\r\nvar fillBreadcrumb = (restaurant=self.restaurant) => {\r\n  const breadcrumb = document.getElementById('breadcrumbOL');\r\n  let a = document.createElement('a');\r\n  a.href = `./restaurant.html?id=${restaurant.id}`;\r\n  a.setAttribute('aria-current', 'page');\r\n  a.innerHTML = ` ${restaurant.name}`;\r\n  const li = document.createElement('li');\r\n  li.appendChild(a);\r\n  // li.innerHTML = restaurant.name;\r\n  breadcrumb.appendChild(li);\r\n}\r\n\r\n/**\r\n * Get a parameter by name from page URL.\r\n */\r\nvar getParameterByName = (name, url) => {\r\n  if (!url)\r\n    url = window.location.href;\r\n  name = name.replace(/[\\[\\]]/g, '\\\\$&');\r\n  const regex = new RegExp(`[?&]${name}(=([^&#]*)|&|#|$)`),\r\n    results = regex.exec(url);\r\n  if (!results)\r\n    return null;\r\n  if (!results[2])\r\n    return '';\r\n  return decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n}\r\n\r\nvar getSubmittedReviewInfoAndValidation =(nameID, rateID, commID)=>{\r\n  let name = document.getElementById(nameID).value;\r\n  let comm = document.getElementById(commID).value;\r\n  let rateList = document.getElementsByName(rateID);\r\n  let rate = 0;\r\n  for(let i = 0  ; i < rateList.length ;i++){\r\n    if(rateList[i].checked){\r\n      rate= rateList[i].value;\r\n      break;\r\n    }\r\n  }\r\n  if(rate === 0 || name === '' || name === undefined || comm === '' || comm === undefined){\r\n    alert('Missing Informations to submit your review...');\r\n    return undefined;\r\n  }else{\r\n    let reviewInfo = {'restaurant_id': self.resturantID, \r\n                    'name': name,\r\n                    'rating': rate,\r\n                    'comments': comm,\r\n                    'createdAt': Date.now()};\r\n    return reviewInfo;\r\n  }\r\n}\r\n\r\nvar submitUserReviewForm = ()=>{\r\n  console.log('executing submitUserReviewForm');\r\n  // let name = document.getElementById('reviewerName').value;\r\n  // let comm = document.getElementById('reviewerComment').value;\r\n  // let rateList = document.getElementsByName('rating');\r\n  // let rate = 0;\r\n  // for(let i = 0  ; i < rateList.length ;i++){\r\n  //   if(rateList[i].checked){\r\n  //     rate= rateList[i].value;\r\n  //     break;\r\n  //   }\r\n  // }\r\n\r\n  // if(rate === 0 || name === '' || name === undefined || comm === '' || comm === undefined){\r\n  //   alert('Missing Informations to submit your review...')\r\n  // }else{\r\n  //   let reviewInfo = {'restaurant_id': self.resturantID, \r\n  //                   'name': name,\r\n  //                   'rating': rate,\r\n  //                   'comments': comm,\r\n  //                   'createdAt': Date.now()};\r\n\r\n  let reviewInfo = getSubmittedReviewInfoAndValidation('reviewerName', 'rating', 'reviewerComment');\r\n  if(reviewInfo){\r\n    console.log(reviewInfo);\r\n    \r\n    let jsonData = JSON.stringify(reviewInfo);\r\n    fetch('http://localhost:1337/reviews/', {\r\n        method: 'POST', \r\n        body: jsonData,\r\n        headers: {\r\n          'content-type': 'application/json'\r\n        }\r\n      }\r\n      ).then((response)=>{\r\n        if(response){\r\n          return response.json();\r\n        }else{\r\n          return undefined;\r\n        }\r\n        \r\n      }).catch((e)=>{\r\n        console.log(e);\r\n      }).then((jsonObj)=>{\r\n        //TODO \r\n        // check its completed successfully or not\r\n        if(jsonObj){\r\n          console.log('sucess ......');\r\n          console.log(jsonObj);\r\n          // refetch and update DB\r\n          afterSubmittingReviewSuccess();\r\n        }else{\r\n          // error \r\n          addToSyncListReviews(jsonData, CATEGORY_NEW_REVIEW);\r\n          afterSubmittingReviewFail(reviewInfo);\r\n          alert('Your review will be submitted when you go online or the review service running..');\r\n        }\r\n      });\r\n     clearSubmittedReview('reviewerName', 'rating', 'reviewerComment');\r\n  \r\n  }\r\n}\r\n\r\n\r\nvar afterSubmittingReviewSuccess = ()=>{\r\n  DBHelper.fetchRestaurantReviews(resturantID, (error, reviews) => {\r\n      if (!reviews) {\r\n        console.error(error);\r\n        return;\r\n      }\r\n      fillReviewsHTML(null ,reviews);\r\n  });\r\n}\r\n\r\nvar afterSubmittingReviewFail = (review)=>{\r\n  const ul = document.getElementById('reviews-list');\r\n  ul.appendChild(createReviewHTML(review));\r\n}\r\n\r\nvar clearSubmittedReview = (reviewerName, rating, reviewerComment)=>{\r\n  document.getElementById(reviewerName).value = '';\r\n  document.getElementById(reviewerComment).value = '';\r\n  let rateList = document.getElementsByName(rating);\r\n\r\n  for(let i = 0  ; i < rateList.length ;i++){\r\n    if(rateList[i].checked){\r\n      rateList[i].checked = false;\r\n      break;\r\n    }\r\n  }\r\n}\r\n\r\n\r\nvar deleteReviewAction=(reviewID)=>{\r\n  let result = window.confirm('Confirm to delete');\r\n  if(result){\r\n    console.log('Start deleting action id:' + reviewID);\r\n    let successCallback = ()=>{\r\n      DBHelper.fetchRestaurantReviews(self.resturantID, \r\n        fillReviewsHTML, undefined);\r\n      customNotification('Review Deleted successfully');\r\n    }\r\n\r\n    let failCallback = (revid)=>{\r\n      let obj = {'id': revid, 'restaurant_id': self.resturantID};\r\n      let storedObject = JSON.stringify(obj);\r\n      addToSyncListReviews(storedObject, CATEGORY_DELETE_REVIEW);\r\n      afterDeletingReviewFailure(revid);\r\n    }\r\n    deleteReview(reviewID, successCallback, failCallback);\r\n  }\r\n}\r\n\r\nvar afterDeletingReviewFailure=(reviewID)=>{\r\n  let revDiv = document.getElementById(`${SINGLE_REVIEW_DIV_PREFIX}${reviewID}`);\r\n  revDiv.innerHTML = '';\r\n}\r\n\r\n\r\nvar getReviewByID = (id)=>{\r\n  // for(let rev of restaurantReviewsList){\r\n  //   if(rev.id === id){\r\n  //     return rev;\r\n  //   }\r\n  // }\r\n  for(let index = 0 ; index < restaurantReviewsList.length ; index++){\r\n    if(restaurantReviewsList[index].id === id){\r\n      return index;\r\n    }\r\n  }\r\n  return undefined;\r\n}\r\n\r\nvar createEditReviewSection = (reviewID)=>{\r\n  let revDev = document.getElementById(`${SINGLE_REVIEW_DIV_PREFIX}${reviewID}`);\r\n  originalModifiedReviewsInnerHTML.set(reviewID, revDev.innerHTML);\r\n  revDev.innerHTML = '';\r\n  revDev.className = 'editReviews';\r\n  revDev.setAttribute('role', 'form');\r\n  revDev.setAttribute('aria-labelledby','editReviewLabel');\r\n\r\n  \r\n  let hd = document.createElement('h4');\r\n  let p1 = document.createElement('p1');\r\n  p1.innerHTML = 'Edit Review:';\r\n  hd.appendChild(p1);\r\n  hd.className = 'reviewHead';\r\n\r\n  revDev.appendChild(hd);\r\n\r\n  let index = getReviewByID(reviewID);\r\n  let review = restaurantReviewsList[index];\r\n\r\n  let name = document.createElement('input');\r\n  name.type = 'text';\r\n  name.value = review.name;\r\n  name.id = `${EDIT_REVIEW_NAME_ID_PREFIX}${review.id}`;\r\n  name.setAttribute('maxlength', 50);\r\n  let nmLbl = document.createElement('label');\r\n  nmLbl.innerHTML = 'Reviewer Name: ';\r\n  nmLbl.setAttribute('for',name.id);\r\n  revDev.appendChild(nmLbl);\r\n  revDev.appendChild(name);\r\n\r\n  let rateDiv1 = document.createElement('div');\r\n  rateDiv1.className = 'modifyReviewRating';\r\n  rateDiv1.id = `${EDIT_REVIEW_RATING_ID_PREFIX}${review.id}`;\r\n  rateDiv1.setAttribute('name', rateDiv1.id);\r\n  generateRatingStars(rateDiv1, review.rating, review.id);\r\n  revDev.appendChild(rateDiv1);\r\n\r\n  let comm = document.createElement('textarea');\r\n  comm.id = `${EDIT_REVIEW_COMM_ID_PREFIX}${review.id}`;\r\n  comm.value =review.comments;\r\n  comm.setAttribute('maxlength', 1000);\r\n  let commLbl = document.createElement('label');\r\n  commLbl.className = 'reviewerCommentLabel';\r\n  commLbl.setAttribute('for',comm.id);\r\n  commLbl.innerHTML = 'Edit The Review Comment here';\r\n\r\n  revDev.appendChild(commLbl);\r\n  revDev.appendChild(comm);\r\n\r\n  // let actionDev = document.createElement('div');\r\n  // actionDev.className = 'reviewActionsDiv';\r\n  // let save = document.createElement('button');\r\n  // save.setAttribute('onclick', `saveUpdatedReview({'reviewID': ${reviewID}, 'index':${index}})`);\r\n  // let sp1 = document.createElement('span');\r\n  // sp1.className = 'fontawesome-save';\r\n  // sp1.innerHTML = 'Save';\r\n  // save.appendChild(sp1);\r\n  // let cancel = document.createElement('button');\r\n  // cancel.setAttribute('onclick', `cancelEditingReview({'reviewID': ${reviewID}, 'index':${index}})`);\r\n  // let sp2 = document.createElement('span');\r\n  // sp2.className = 'fontawesome-remove-sign';\r\n  // sp2.innerHTML = 'Exit';\r\n  // cancel.appendChild(sp2);\r\n\r\n  // actionDev.appendChild(save);\r\n  // actionDev.appendChild(cancel);\r\n\r\n  // revDev.appendChild(actionDev);\r\n  createEdititedReviewActionsButtons(revDev, reviewID, index);\r\n}\r\n\r\nvar createEdititedReviewActionsButtons=(div, reviewID, index)=>{\r\n  \r\n  let save = document.createElement('button');\r\n  save.setAttribute('onclick', `saveUpdatedReview({'reviewID': ${reviewID}, 'index':${index}})`);\r\n  let sp1 = document.createElement('span');\r\n  sp1.className = 'fontawesome-save';\r\n  sp1.innerHTML = 'Save';\r\n  save.className = 'editReviewActionButton';\r\n  save.setAttribute('role', 'presentation');\r\n  save.setAttribute('aria-label', 'Save Modified Review');\r\n  save.appendChild(sp1);\r\n\r\n  let cancel = document.createElement('button');\r\n  cancel.setAttribute('onclick', `cancelEditingReview({'reviewID': ${reviewID}, 'index':${index}})`);\r\n  let sp2 = document.createElement('span');\r\n  sp2.className = 'fontawesome-remove-sign';\r\n  sp2.innerHTML = 'Exit';\r\n  cancel.className = 'editReviewActionButton';\r\n  cancel.setAttribute('role', 'presentation');\r\n  cancel.setAttribute('aria-label', 'Discard Review modifications');\r\n  cancel.appendChild(sp2);\r\n\r\n  div.appendChild(save);\r\n  div.appendChild(cancel);\r\n\r\n}\r\n\r\nvar generateRatingStars = (rateDiv, rating, revID) =>{\r\n  generateStar(rateDiv, 1, 'Sucks big time', revID, rating);\r\n  generateStar(rateDiv, 2, 'Kinda bad', revID, rating);\r\n  generateStar(rateDiv, 3, 'Meh', revID, rating);\r\n  generateStar(rateDiv, 4, 'Pretty good', revID, rating);\r\n  generateStar(rateDiv, 5, 'Awesome', revID, rating);\r\n  \r\n}\r\n\r\nvar generateStar = (div,val, txt, revID, rating)=>{\r\n  let s1 = document.createElement('input');\r\n  s1.type = 'radio';\r\n  s1.id = `_star${val}`;\r\n  s1.name = `${EDIT_REVIEW_RADIO_NAME_PREF}${revID}`;\r\n  s1.value = val;\r\n  \r\n  let l1 = document.createElement('label');\r\n  // l1.className = 'full';\r\n  l1.setAttribute('for',s1.id);\r\n  l1.title = `${txt} - ${val} stars`;\r\n  l1.innerHTML = `${val} &#9734;`;\r\n\r\n  if(Number.parseInt(rating, 10) === val){\r\n    s1.setAttribute('checked', true);\r\n  }\r\n\r\n  div.appendChild(s1);\r\n  div.appendChild(l1);\r\n}\r\n\r\nvar editExistingReview= (reviewID)=>{\r\n  createEditReviewSection(reviewID);\r\n}\r\n\r\nvar cancelEditingReview=(info)=>{\r\n  let result = window.confirm('Discard Changes ?');\r\n  if(result){\r\n    let reviewID = info.reviewID;\r\n    let index = info.index;\r\n    let revDev = document.getElementById(`review_${reviewID}`);\r\n    revDev.innerHTML = originalModifiedReviewsInnerHTML.get(reviewID);\r\n    originalModifiedReviewsInnerHTML.delete(reviewID);\r\n  }\r\n}\r\n\r\nvar saveUpdatedReview= (info)=>{\r\n  let reviewID = info.reviewID;\r\n  let index = info.index;\r\n  let reviewInfo = getSubmittedReviewInfoAndValidation(`${EDIT_REVIEW_NAME_ID_PREFIX}${reviewID}`, \r\n    `${EDIT_REVIEW_RADIO_NAME_PREF}${reviewID}`, `${EDIT_REVIEW_COMM_ID_PREFIX}${reviewID}`);\r\n  \r\n  if(reviewInfo){\r\n    let result = window.confirm('Confirm to apply the changes?');\r\n    if(result){\r\n      console.log('Start updating the review: ' + reviewID + 'with below info');\r\n      console.log(reviewInfo);\r\n      reviewInfo.review_id = reviewID;\r\n\r\n      let jsonData = JSON.stringify(reviewInfo);\r\n\r\n      let failCallback = (response)=>{\r\n        let myRev = restaurantReviewsList[index];\r\n        myRev.name = reviewInfo.name;\r\n        myRev.comments = reviewInfo.comments;\r\n        myRev.rating = reviewInfo.rating;\r\n\r\n        addToSyncListReviews(jsonData,CATEGORY_UPDATE_REVIEW);\r\n\r\n        let mydiv = document.getElementById(`${SINGLE_REVIEW_DIV_PREFIX}${reviewID}`);\r\n        mydiv.innerHTML = '';\r\n        createReviewHTML(myRev, mydiv);\r\n      }\r\n\r\n      updateRestaurantReview(jsonData,afterSubmittingReviewSuccess, failCallback);\r\n\r\n      originalModifiedReviewsInnerHTML.delete(reviewID);\r\n    }\r\n  }\r\n}"]}